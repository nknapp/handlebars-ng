---
import { EcmaGrammar } from "./ecmaGrammar";

interface Props {
  filename: string;
  contents: string;
  hash?: string;
}

const { contents, hash } = Astro.props;

let grammar = await EcmaGrammar.fromString(contents);
// TODO: Make sure that "hash" is undefined or null if no hash is provided
if (typeof hash === "string") {
  const selectedProductions = hash.split(",");
  grammar = grammar.selectProductions(selectedProductions);
}
---

<div class="my-4">
  <div class="border-l pl-2 py-2" set:html={grammar.html} />
</div>
<style lang="scss" is:global>
  .grammar {
    white-space: nowrap;
    word-spacing: 0.5rem;
    overflow: auto;

    .nonterminal {
      @apply italic;
    }

    .unicode-character-literal,
    .terminal,
    .keyword {
      @apply font-bold;
    }

    .punctuation {
    }

    .rhs,
    .one-of-list {
      display: block;
      margin-left: 5rem;
      line-height: 2rem;
    }

    .prose {
      font-family: serif;
    }

    .parameter-list,
    .argument-list,
    .opt {
      @apply text-xs text-cyan-600 font-bold ml-1 transform translate-y-1 inline-block;
      word-spacing: normal;
    }
  }
</style>
